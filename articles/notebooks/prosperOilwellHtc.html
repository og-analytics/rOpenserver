<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>prosperOilwellHtc â€¢ rOpenserver</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="prosperOilwellHtc">
<meta property="og:description" content="rOpenserver">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">rOpenserver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9015</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/prosper-hello_world.html">Prosper Hello World!</a>
    </li>
    <li>
      <a href="../../articles/gap-hello_world.html">GAP Hello World!</a>
    </li>
    <li>
      <a href="../../articles/mbal-hello_world.html">MBAL Hello World!</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Notebooks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/notebooks/prosperHorizNodeSys.html">Calculate liquid rate when varying well length, vertical anisotropy and wellhead pressure</a>
    </li>
    <li>
      <a href="../../articles/notebooks/prosperHorizSys.html">Calculate liquid rate when varying well length and vertical anisotropy</a>
    </li>
    <li>
      <a href="../../articles/notebooks/mbalPredByOoip.html">Run prediction given an OOIP</a>
    </li>
    <li>
      <a href="../../articles/notebooks/prosperOilwellHtc.html">Calculate well variables at diiferent Heat Transfer Coefficients</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../reference/index.html">Functions and Classes</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/f0nzie/rOpenserver">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="prosperOilwellHtc_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>prosperOilwellHtc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/f0nzie/rOpenserver/blob/master/vignettes/notebooks/prosperOilwellHtc.Rmd"><code>vignettes/notebooks/prosperOilwellHtc.Rmd</code></a></small>
      <div class="hidden name"><code>prosperOilwellHtc.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># prosperOilwellHtc</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rOpenserver</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="co"># function to get the filename for the model</span>
<span class="no">get_model_filename</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">model</span>) {
    <span class="no">models_dir</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"models"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"rOpenserver"</span>)
    <span class="no">model_file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">models_dir</span>, <span class="no">model</span>)
    <span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(<span class="no">model_file</span>)) <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Model not found ..."</span>) <span class="kw">else</span>
        <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">model_file</span>)
}</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># well lengths and vertical anisotropy vectors</span>
<span class="no">htc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">2</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">htc</span>)
<span class="no">df</span>[<span class="st">"liquid_rate"</span>]     <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="no">df</span>[<span class="st">"wellhead_temp"</span>]   <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="no">df</span>[<span class="st">"sol_bhp"</span>]         <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="no">df</span>[<span class="st">"sol_dp_friction"</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>

<span class="co"># openserver variables</span>
<span class="no">sys_sol_liqrate</span>       <span class="kw">&lt;-</span> <span class="st">"PROSPER.OUT.SYS.RESULTS[0][0][0].SOL.LIQRATE"</span>
<span class="no">sys_sol_whtemperature</span> <span class="kw">&lt;-</span> <span class="st">"PROSPER.OUT.SYS.RESULTS[0][0][0].SOL.WHTEMPERATURE"</span>
<span class="no">sys_sol_bhp</span>           <span class="kw">&lt;-</span> <span class="st">"PROSPER.OUT.SYS.Results[0].Sol.BHP"</span>
<span class="no">sys_prfric</span>            <span class="kw">&lt;-</span> <span class="st">"PROSPER.OUT.SYS.Results[0].Sol.PRFRIC"</span></pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Initialize and start OpenServer</span>
<span class="no">pserver</span> <span class="kw">&lt;-</span> <span class="no">OpenServerR6</span>$<span class="fu">new</span>()     <span class="co"># another way to start an OpenServer instance</span>
<span class="no">cmd</span> <span class="kw">=</span> <span class="st">"PROSPER.START"</span>
<span class="fu"><a href="../../reference/DoCmd.html">DoCmd</a></span>(<span class="no">pserver</span>, <span class="no">cmd</span>)</pre></body></html></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># open model</span>
<span class="no">model_file</span> <span class="kw">&lt;-</span> <span class="fu">get_model_filename</span>(<span class="kw">model</span> <span class="kw">=</span> <span class="st">"oilwell.Out"</span>)
<span class="no">open_cmd</span> <span class="kw">&lt;-</span> <span class="st">"PROSPER.OPENFILE"</span>
<span class="no">open_cmd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">open_cmd</span>, <span class="st">"('"</span>, <span class="no">model_file</span>, <span class="st">"')"</span>)
<span class="fu"><a href="../../reference/DoCmd.html">DoCmd</a></span>(<span class="no">pserver</span>, <span class="no">open_cmd</span>)</pre></body></html></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># iterate through heat transfer coefficient vector</span>
<span class="no">i</span> <span class="kw">&lt;-</span>  <span class="fl">1</span>
<span class="kw">for</span> (<span class="no">h</span> <span class="kw">in</span> <span class="no">df</span><span class="kw">[[</span><span class="st">"htc"</span>]]) {
    <span class="co"># set HTC</span>
    <span class="fu"><a href="../../reference/DoSet.html">DoSet</a></span>(<span class="no">pserver</span>, <span class="st">"PROSPER.SIN.EQP.Geo.Htc"</span>, <span class="no">h</span>)
    <span class="fu"><a href="../../reference/DoCmd.html">DoCmd</a></span>(<span class="no">pserver</span>, <span class="st">"PROSPER.anl.SYS.CALC"</span>)    <span class="co"># do calculation</span>
    <span class="co"># store liquid rate, wellhead temperature, solution BHP and dP friction</span>
    <span class="no">df</span><span class="kw">[[</span><span class="st">"liquid_rate"</span>]][<span class="no">i</span>]     <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span>(<span class="fu"><a href="../../reference/DoGet.html">DoGet</a></span>(<span class="no">pserver</span>, <span class="no">sys_sol_liqrate</span>))
    <span class="no">df</span><span class="kw">[[</span><span class="st">"wellhead_temp"</span>]][<span class="no">i</span>]   <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span>(<span class="fu"><a href="../../reference/DoGet.html">DoGet</a></span>(<span class="no">pserver</span>, <span class="no">sys_sol_whtemperature</span>))
    <span class="no">df</span><span class="kw">[[</span><span class="st">"sol_bhp"</span>]][<span class="no">i</span>]         <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span>(<span class="fu"><a href="../../reference/DoGet.html">DoGet</a></span>(<span class="no">pserver</span>, <span class="no">sys_sol_bhp</span>))
    <span class="no">df</span><span class="kw">[[</span><span class="st">"sol_dp_friction"</span>]][<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span>(<span class="fu"><a href="../../reference/DoGet.html">DoGet</a></span>(<span class="no">pserver</span>, <span class="no">sys_prfric</span>))
    <span class="no">i</span> <span class="kw">&lt;-</span>  <span class="no">i</span> + <span class="fl">1</span>
}</pre></body></html></div>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">df</span>)</pre></body></html></div>
<pre><code>    htc liquid_rate wellhead_temp  sol_bhp sol_dp_friction
1   2.0    12207.70      193.8414 2669.929        514.1321
2   2.5    12201.75      190.1239 2671.276        512.6521
3   3.0    12195.78      186.5259 2672.628        511.1868
4   3.5    12189.82      183.0434 2673.978        509.7431
5   4.0    12182.66      179.6687 2675.599        508.3648
6   4.5    12176.46      176.4035 2677.004        506.7877
7   5.0    12170.23      173.2415 2678.415        505.2016
8   5.5    12164.05      170.1792 2679.813        503.6503
9   6.0    12157.92      167.2131 2681.202        502.1317
10  6.5    12151.84      164.3399 2682.580        500.6453
11  7.0    12145.80      161.5562 2683.948        499.1901
12  7.5    12139.76      158.8588 2685.316        497.7242
13  8.0    12133.74      156.2446 2686.678        496.2813
14  8.5    12127.75      153.7108 2688.035        494.8627
15  9.0    12120.55      151.2492 2689.666        493.6298
16  9.5    12102.93      148.8171 2693.657        493.7540
17 10.0    12097.17      146.5076 2694.961        492.4105</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># convert dataframe to tidy dataset</span>
<span class="no">df_gather</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="no">df</span>, <span class="no">var</span>, <span class="no">value</span>, <span class="no">liquid_rate</span>:<span class="no">sol_dp_friction</span>)

<span class="co"># plot</span>
<span class="no">g</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">df_gather</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">htc</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="no">var</span> ~<span class="no">.</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free_y"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">g</span>)</pre></body></html></div>
<p><img src="prosperOilwellHtc_files/figure-html/dataframe_plots-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># shutdown Prosper</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="fl">3</span>)
<span class="no">command</span> <span class="kw">=</span> <span class="st">"PROSPER.SHUTDOWN"</span>
<span class="no">pserver</span>$<span class="fu"><a href="../../reference/DoCmd.html">DoCmd</a></span>(<span class="no">command</span>)</pre></body></html></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">pserver</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span></pre></body></html></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alfonso R. Reyes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
